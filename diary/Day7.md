# Day7
偷懶後，要多花一倍時間補回來

## 相對名稱
前兩天都在探討名稱相關的問題，有看到「絕對名稱」、「參照名稱」等，參照又分成一般跟符號，用法大概就是一般會指向絕對名稱，而符號參照會指向一般參照這樣。

### 物件關係

![](https://i.imgur.com/EEITqPN.png)

查看這兩個絕對名稱後，可以看出來，除了第一次的commit沒有parent外，其他版本都會有一個parent代表它前一個版本，而相對名稱便是利用這些關係幫助我們找到相對的版本內容。

### ^ 和 ~
因為在windows的command line，所以以下圖中看到`^^`都是指`^`。

![](https://i.imgur.com/blAqqyC.png)

仔細看看這兩張圖，裡面都是利用branch1這個參照名稱來查看資訊，而左邊每一種用法都是指向同一個版本，而右邊也是，而這些關係是?

以下用HEAD舉例，可以知道往前一個版本的辦法

- 前一個版本
  - HEAD^
  - HEAD~
  - HEAD^1
  - HEAD~1

而往前兩個版本呢?就是把往前重複兩次就行了，像是`HEAD^^`或`HEAD~~`，比較特別的是`~`它寫成`~N`時可以用作往前N個版本，像是`HEAD~3`就是前三個版本，但`^`卻不行，`^2`的意思不是前兩個版本，而是前一個版本的第二種版本，說起來饒舌，不過就是經過merge後才會發生的狀況。

![](https://i.imgur.com/oY37F5J.png)

用個圖說明狀況就是，某兩個版本merge後，HEAD(現在版本)可以利用`^1`或`^2`來查看其中一條線路，而`^1`繼續向下可以被省略，但`^2`的版本要往下第一步都是先`^2`之後才能往下查看那條分支。

## 查看絕對名稱
利用`git rev-parse [Name]`就能查看絕對名稱。

![](https://i.imgur.com/xP5zr8h.png)

## 暫存版本
如果工作到一半卻還沒更新完成，此時需要對同一個專案做修正時。我們不會希望把更新一半的當做一個版本，但也不想讓這版本有兩個修改部分並行，git有個方式可以讓現在狀態保存卻不留下版本的方式，就是站存版本。

### 檔案類別
首先我們要再次認知修改到一半時檔案在git上的狀態有分新增、修改跟刪除，而這些檔案又分成已加入索引跟未加入索引，甚至是未追蹤的狀態。

### git stash
用`git stash`就能將現在的狀態保存到暫存版本並回到最開始的樣子，而`git stash -u`則會將全部狀態都保存下來，而其中差別在於加上`-u`會將未追蹤的檔案也一並加入。

 ### stash 內容
 我們用`git cat-file -p stash`來查看狀態，可以看見有三個parent。
 
 ![](https://i.imgur.com/Q7zoRY4.png)

而這時可以用前面嘗試的`^2`來查看三個parent的資訊。

![](https://i.imgur.com/B8AfBc6.png)

而這三個版本的內容分別是。

1. HEAD(原本的狀態)
2. 原本目錄下已追蹤的檔案(已加入索引的檔案)
3. 未追蹤的檔案(剛新增還不在索引檔中)

由此可知，用`git stash -u`後的動作是，將追蹤但未更新的檔案分成一個分支，將還未追蹤的檔案分出分支，然後將這兩個分支跟原本目錄(HEAD)的狀態merge成新的暫存版本。然後退回HEAD狀態。

### 回復狀態
`git stash pop`就能將當時stash的狀態跟當前狀態合併。將未更新的部分回復到stash前。

## 多重暫存
雖然如果暫存太多不是很好的習慣，不過還是可以做到。然後stash狀態會是像stack一樣越後儲存的版本越上方，所以用pop時會從最後儲存的版本先出來。

### 查看
`git stash list`就能查看當前被暫存的版本一覽。
而既然它能稱做版本，就表示一樣可以做注解，而注解方式就是在版本暫存時，打`git stash save -u "something"`就能對版本加上注解以方便我們查看。
下圖就是兩個使用狀況。

![](https://i.imgur.com/AdN6lSU.png)

### 取出特定版本
`git apply "stash@{N}"`就能將N的狀態回復，而跟pop不同的地方除了可以指定狀態，還有就是不會被刪除，用`git stash list`的時後`stash@{N}`一樣存在。

![](https://i.imgur.com/CN9KrAU.png)

### 刪除狀態
`git drop "stash@{N}"`就能將`stash@{N}` 刪除，而要清除全部stash就用`git stash clear`就可以了。

## 今日結語
漏了一天完全沒有東西，只好一天看兩個部份了。不過剛好這兩個部分剛好有可以應用的部分，算是不錯。

